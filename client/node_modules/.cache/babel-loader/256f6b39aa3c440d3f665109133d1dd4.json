{"ast":null,"code":"import _slicedToArray from\"/home/ec2-user/findsportsbuddy/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";//display this map when users go to /sportsMap\n//does not need to be logged in to see this\n//shows all the current events registered nearby\n//Author: Zolboo Erdenebaatar\nimport{GoogleMap,useLoadScript,Marker,InfoWindow}from'@react-google-maps/api';import mapStyles from'./mapStyles';import axios from'axios';import React,{useEffect}from'react';import CustomNavbar from'./CustomNavbar';import CustomFooter from'./CustomFooter';import'./DisplayMap.css';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CONFIG=require('./../config.json');var libraries=[\"places\"];//function that returns the custom map\nvar mapContainerStyle={width:\"66vw\",height:\"80vh\"};var options={styles:mapStyles,disableDefaultUI:true};export default function DisplayMap(props){//load the maps\nvar _useLoadScript=useLoadScript({googleMapsApiKey:CONFIG.JS_MAPS_KEY,libraries:libraries}),isLoaded=_useLoadScript.isLoaded,loadError=_useLoadScript.loadError;//markers = events to show up on the map\nvar _React$useState=React.useState(),_React$useState2=_slicedToArray(_React$useState,2),markers=_React$useState2[0],setMarker=_React$useState2[1];var _React$useState3=React.useState(),_React$useState4=_slicedToArray(_React$useState3,2),selected=_React$useState4[0],setSelected=_React$useState4[1];//load the center\nvar params=new URLSearchParams(props.location.search);var center={lat:38.8977,lng:77.0365};if(localStorage.getItem(\"selectedLocation\")){var savedLocation=localStorage.getItem(\"selectedLocation\");var split=savedLocation.split(' ');center={lat:parseFloat(split[0]),lng:parseFloat(split[1])};}if(params.get(\"lat\")){center={lat:parseFloat(params.get(\"lat\")),lng:parseFloat(params.get(\"lng\"))};}//import the active events\nuseEffect(function(){axios.get(CONFIG.API_URL+'/events/getAll').then(function(events){var newMarkers=events.data.filter(//filter out the old events\nfunction(event){var eventTime=new Date(event.end_time).getTime();if(eventTime<=Date.now()){return false;}function deg2rad(deg){return deg*(Math.PI/180);}var loc=event.location.split(\" \");var lat1=center.lat;var lon1=center.lng;var lat2=parseFloat(loc[0]);var lon2=parseFloat(loc[1]);//filter out the events that are too far positionally\nvar R=6371;// Radius of the earth in km\nvar dLat=deg2rad(lat2-lat1);// deg2rad below\nvar dLon=deg2rad(lon2-lon1);var a=Math.sin(dLat/2)*Math.sin(dLat/2)+Math.cos(deg2rad(lat1))*Math.cos(deg2rad(lat2))*Math.sin(dLon/2)*Math.sin(dLon/2);var c=2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a));var d=R*c;// Distance in km\nif(d>5){return false;}return true;}).map(function(event){//map the events to markers\nvar loc=event.location.split(\" \");var curLat=parseFloat(loc[0]);var curLng=parseFloat(loc[1]);var starttime=new Date(event.start_time).toTimeString().substring(0,5);var endtime=new Date(event.end_time).toTimeString().substring(0,5);var thisDate=event.start_time.substring(0,10);var host=event.host;return{id:event.id,lat:curLat,creator:host,lng:curLng,sportName:event.sport_type,startTime:starttime,date:thisDate,endTime:endtime,numParticipants:event.num_participants};});setMarker(newMarkers);});},[]);if(loadError)return\"LoadError\";if(!isLoaded)return\"Loading\";return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(CustomNavbar,{}),/*#__PURE__*/_jsxs(\"div\",{className:\"is-fullheight-with-navbar\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"title has-text-centered\",children:[\"Join These Activities Near You (or \",/*#__PURE__*/_jsx(\"a\",{href:\"/hostEvent\",children:\"Host Your Own)\"})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"subtitle has-text-centered\",children:\"Click on the emoji for more information\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"column is-one-third scrollable\",children:[markers&&markers.map(function(marker){return/*#__PURE__*/_jsx(\"div\",{className:\"box moreinfobox\",onMouseEnter:function onMouseEnter(){setSelected(marker);},onMouseLeave:function onMouseLeave(){setSelected(null);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"columns\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"column is-one-third\",children:/*#__PURE__*/_jsx(\"img\",{src:\"/emojis/\"+marker.sportName+\".png\",alt:\"sportemoji\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"column\",children:[/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-4\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"has-text-weight-semibold\",children:\"What: \"}),marker.sportName]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-5\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"has-text-weight-semibold\",children:\"When: \"}),marker.startTime,\"-\",marker.endTime,\" (\",marker.date,\")\"]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-5\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"has-text-weight-semibold\",children:\"How many people: \"}),marker.numParticipants]})}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"span\",{className:\"is-size-5\",children:[/*#__PURE__*/_jsx(\"span\",{className:\"has-text-weight-semibold\",children:\"Created by: \"}),marker.creator]})})]})]})},marker.id);}),(!markers||markers.length===0)&&/*#__PURE__*/_jsxs(\"div\",{className:\"box is-size-4 has-text-weight-semibold has-text-danger no-event-box\",children:[\"Hmmmmm... It looks like there is no sport event near you. However, you can host your own here:\",/*#__PURE__*/_jsx(\"div\",{className:\"outerHostEvent\",children:/*#__PURE__*/_jsx(\"a\",{className:\"button is-success is-large is-rounded m-4\",id:\"neweventbutton\",href:\"/hostEvent\",children:\"Host your own event\"})})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"column\",children:/*#__PURE__*/_jsx(\"div\",{className:\"container container-extra\",children:/*#__PURE__*/_jsxs(GoogleMap,{mapContainerStyle:mapContainerStyle,zoom:15,center:center,options:options,children:[markers&&markers.map(function(marker){return/*#__PURE__*/_jsx(Marker,{position:{lat:marker.lat,lng:marker.lng},onClick:function onClick(){console.log(marker);setSelected(marker);},icon:{url:\"/emojis/\"+marker.sportName+\".png\",scaledSize:new window.google.maps.Size(30,30),origin:new window.google.maps.Point(0,0),anchor:new window.google.maps.Point(15,15)}},marker.id);}),selected&&/*#__PURE__*/_jsx(InfoWindow,{position:{lat:selected.lat,lng:selected.lng},onCloseClick:function onCloseClick(){setSelected(null);},children:/*#__PURE__*/_jsxs(\"div\",{className:\"card\",children:[/*#__PURE__*/_jsx(\"header\",{className:\"card-header\",children:/*#__PURE__*/_jsx(\"p\",{className:\"card-header-title\",children:selected.sportName})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-content\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Starts: \",selected.startTime]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Ends: \",selected.endTime]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"# of people: \",selected.numParticipants]})]})]})})]})})})]})]}),/*#__PURE__*/_jsx(CustomFooter,{})]});}","map":{"version":3,"sources":["/home/ec2-user/findsportsbuddy/client/src/Components/DisplayMap.js"],"names":["GoogleMap","useLoadScript","Marker","InfoWindow","mapStyles","axios","React","useEffect","CustomNavbar","CustomFooter","CONFIG","require","libraries","mapContainerStyle","width","height","options","styles","disableDefaultUI","DisplayMap","props","googleMapsApiKey","JS_MAPS_KEY","isLoaded","loadError","useState","markers","setMarker","selected","setSelected","params","URLSearchParams","location","search","center","lat","lng","localStorage","getItem","savedLocation","split","parseFloat","get","API_URL","then","events","newMarkers","data","filter","event","eventTime","Date","end_time","getTime","now","deg2rad","deg","Math","PI","loc","lat1","lon1","lat2","lon2","R","dLat","dLon","a","sin","cos","c","atan2","sqrt","d","map","curLat","curLng","starttime","start_time","toTimeString","substring","endtime","thisDate","host","id","creator","sportName","sport_type","startTime","date","endTime","numParticipants","num_participants","marker","length","console","log","url","scaledSize","window","google","maps","Size","origin","Point","anchor"],"mappings":"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","sourcesContent":["//display this map when users go to /sportsMap\n//does not need to be logged in to see this\n//shows all the current events registered nearby\n//Author: Zolboo Erdenebaatar\nimport { GoogleMap, useLoadScript, Marker, InfoWindow } from '@react-google-maps/api';\nimport mapStyles from './mapStyles';\nimport axios from 'axios';\nimport React, { useEffect } from 'react';\nimport CustomNavbar from './CustomNavbar';\nimport CustomFooter from './CustomFooter';\nimport './DisplayMap.css';\nvar CONFIG = require('./../config.json');\n\nconst libraries = [\"places\"];\n//function that returns the custom map\nconst mapContainerStyle = {\n    width: \"66vw\",\n    height: \"80vh\"\n}\n\nconst options = {\n    styles: mapStyles,\n    disableDefaultUI: true\n}\nexport default function DisplayMap(props) {\n    //load the maps\n    const { isLoaded, loadError } = useLoadScript({\n        googleMapsApiKey: CONFIG.JS_MAPS_KEY,\n        libraries\n    });\n    //markers = events to show up on the map\n    var [markers, setMarker] = React.useState();\n    const [selected, setSelected] = React.useState();\n    //load the center\n    const params = new URLSearchParams(props.location.search);\n    var center = { lat: 38.8977, lng: 77.0365 }\n    if (localStorage.getItem(\"selectedLocation\")) {\n        const savedLocation = localStorage.getItem(\"selectedLocation\");\n        const split = savedLocation.split(' ')\n        center = {\n            lat: parseFloat(split[0]),\n            lng: parseFloat(split[1])\n        }\n    }\n    if (params.get(\"lat\")) {\n        center = {\n            lat: parseFloat(params.get(\"lat\")),\n            lng: parseFloat(params.get(\"lng\"))\n        }\n    }\n    //import the active events\n    useEffect(() => {\n        axios.get(CONFIG.API_URL + '/events/getAll').then(\n            (events) => {\n                var newMarkers = events.data.filter(\n                    //filter out the old events\n                    function (event) {\n                        const eventTime = new Date(event.end_time).getTime();\n                        if (eventTime <= Date.now()) {\n                            return false;\n                        }\n                        function deg2rad(deg) {\n                            return deg * (Math.PI / 180)\n                        }\n                        var loc = event.location.split(\" \");\n                        const lat1 = center.lat;\n                        const lon1 = center.lng;\n                        const lat2 = parseFloat(loc[0]);\n                        const lon2 = parseFloat(loc[1]);\n                        //filter out the events that are too far positionally\n                        var R = 6371; // Radius of the earth in km\n                        var dLat = deg2rad(lat2 - lat1);  // deg2rad below\n                        var dLon = deg2rad(lon2 - lon1);\n                        var a =\n                            Math.sin(dLat / 2) * Math.sin(dLat / 2) +\n                            Math.cos(deg2rad(lat1)) * Math.cos(deg2rad(lat2)) *\n                            Math.sin(dLon / 2) * Math.sin(dLon / 2)\n                            ;\n                        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));\n                        var d = R * c; // Distance in km\n                        if (d > 5) {\n                            return false;\n                        }\n                        return true;\n                    }\n                ).map(\n                    function (event) {\n                        //map the events to markers\n                        var loc = event.location.split(\" \");\n                        var curLat = parseFloat(loc[0]);\n                        var curLng = parseFloat(loc[1]);\n                        var starttime = (new Date(event.start_time).toTimeString()).substring(0, 5);\n                        var endtime = (new Date(event.end_time).toTimeString()).substring(0, 5);\n                        var thisDate = event.start_time.substring(0, 10);\n                        var host = event.host;\n                        return {\n                            id: event.id,\n                            lat: curLat,\n                            creator: host,\n                            lng: curLng,\n                            sportName: event.sport_type,\n                            startTime: starttime,\n                            date: thisDate,\n                            endTime: endtime,\n                            numParticipants: event.num_participants\n                        };\n                    }\n                );\n                setMarker(newMarkers);\n            }\n        )\n    }, []);\n    if (loadError) return \"LoadError\";\n    if (!isLoaded) return \"Loading\";\n    return (\n        <div>\n            <CustomNavbar></CustomNavbar>\n            <div className=\"is-fullheight-with-navbar\">\n                <h1 className=\"title has-text-centered\">Join These Activities Near You (or <a href=\"/hostEvent\">Host Your Own)</a></h1>\n                <h2 className=\"subtitle has-text-centered\">Click on the emoji for more information</h2>\n                <div className=\"columns\">\n                    <div className=\"column is-one-third scrollable\">\n                        {\n                            markers &&\n                            markers.map(\n                                function (marker) {\n                                    return <div className=\"box moreinfobox\"\n                                        onMouseEnter={() => { setSelected(marker) }}\n                                        onMouseLeave={() => { setSelected(null) }}\n                                        key={marker.id}\n                                    >\n                                        <div className=\"columns\">\n                                            <div className=\"column is-one-third\">\n                                                <img src={\"/emojis/\" + marker.sportName + \".png\"} alt=\"sportemoji\" />\n                                            </div>\n                                            <div className=\"column\">\n                                                <div>\n                                                    <span className=\"is-size-4\">\n                                                        <span className=\"has-text-weight-semibold\">What: </span>\n                                                        {marker.sportName}\n                                                    </span>\n                                                </div>\n                                                <div>\n                                                    <span className=\"is-size-5\">\n                                                        <span className=\"has-text-weight-semibold\">When: </span>\n                                                        {marker.startTime}-{marker.endTime} ({marker.date})\n                                                    </span>\n                                                </div>\n                                                <div>\n                                                    <span className=\"is-size-5\">\n                                                        <span className=\"has-text-weight-semibold\">How many people: </span>\n                                                        {marker.numParticipants}\n                                                    </span>\n                                                </div>\n                                                <div>\n                                                    <span className=\"is-size-5\">\n                                                        <span className=\"has-text-weight-semibold\">Created by: </span>\n                                                        {marker.creator}\n                                                    </span>\n                                                </div>\n                                            </div>\n                                        </div>\n                                    </div>\n                                }\n                            )\n                        }\n                        {\n                            (!markers || markers.length === 0) &&\n                            < div className=\"box is-size-4 has-text-weight-semibold has-text-danger no-event-box\">\n                                Hmmmmm... It looks like there is no sport event near you.\n                                However, you can host your own here:\n                                <div className=\"outerHostEvent\">\n                                    <a\n                                        className=\"button is-success is-large is-rounded m-4\"\n                                        id=\"neweventbutton\"\n                                        href=\"/hostEvent\">\n                                        Host your own event\n                                    </a>\n                                </div>\n                            </div>\n                        }\n                    </div>\n                    <div className=\"column\">\n                        <div className=\"container container-extra\">\n                            <GoogleMap\n                                mapContainerStyle={mapContainerStyle}\n                                zoom={15}\n                                center={center}\n                                options={options}\n                            >\n                                {markers &&\n                                    markers.map(\n                                        function (marker) {\n                                            return <Marker\n                                                position={{ lat: marker.lat, lng: marker.lng }}\n                                                onClick={() => {\n                                                    console.log(marker)\n                                                    setSelected(marker);\n                                                }}\n                                                icon={{\n                                                    url: \"/emojis/\" + marker.sportName + \".png\",\n                                                    scaledSize: new window.google.maps.Size(30, 30),\n                                                    origin: new window.google.maps.Point(0, 0),\n                                                    anchor: new window.google.maps.Point(15, 15)\n                                                }}\n                                                key={marker.id}\n                                            ></Marker>\n                                        }\n                                    )\n                                }\n                                {\n                                    selected && (\n                                        <InfoWindow position={{ lat: selected.lat, lng: selected.lng }} onCloseClick={() => { setSelected(null) }}>\n                                            <div className=\"card\">\n                                                <header className=\"card-header\">\n                                                    <p className=\"card-header-title\">\n                                                        {selected.sportName}\n                                                    </p>\n                                                </header>\n                                                <div className=\"card-content\">\n                                                    <p>Starts: {selected.startTime}</p>\n                                                    <p>Ends: {selected.endTime}</p>\n                                                    <p># of people: {selected.numParticipants}</p>\n                                                </div>\n                                            </div>\n                                        </InfoWindow>\n                                    )\n                                }\n                            </GoogleMap>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <CustomFooter />\n        </div >\n    );\n}"]},"metadata":{},"sourceType":"module"}